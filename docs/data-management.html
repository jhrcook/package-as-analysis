<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>2 Data Management | Package as Analysis</title>
  <meta name="description" content="This is a manual for how to conduct data science analysis using the standard R package framework.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="2 Data Management | Package as Analysis" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://jhrcook.github.io/package-as-analysis/" />
  <meta property="og:image" content="https://jhrcook.github.io/package-as-analysis/cover.png" />
  <meta property="og:description" content="This is a manual for how to conduct data science analysis using the standard R package framework." />
  <meta name="github-repo" content="jhrcook/package-as-analysis" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Data Management | Package as Analysis" />
  <meta name="twitter:site" content="@JoshDoesa" />
  <meta name="twitter:description" content="This is a manual for how to conduct data science analysis using the standard R package framework." />
  <meta name="twitter:image" content="https://jhrcook.github.io/package-as-analysis/cover.png" />

<meta name="author" content="Joshua H. Cook">


<meta name="date" content="2019-03-17">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="framework.html">
<link rel="next" href="getting-started.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Package as Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why"><i class="fa fa-check"></i>Why</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#advantages"><i class="fa fa-check"></i>Advantages</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#examples"><i class="fa fa-check"></i>Examples</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about"><i class="fa fa-check"></i>About</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-this-book"><i class="fa fa-check"></i>About this Book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-author"><i class="fa fa-check"></i>About the Author</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#resources"><i class="fa fa-check"></i>Resources</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="framework.html"><a href="framework.html"><i class="fa fa-check"></i><b>1</b> Framework</a><ul>
<li class="chapter" data-level="1.1" data-path="framework.html"><a href="framework.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="framework.html"><a href="framework.html#vignettes"><i class="fa fa-check"></i><b>1.2</b> Vignettes</a><ul>
<li class="chapter" data-level="1.2.1" data-path="framework.html"><a href="framework.html#starting-a-vignette"><i class="fa fa-check"></i><b>1.2.1</b> Starting a Vignette</a></li>
<li class="chapter" data-level="1.2.2" data-path="framework.html"><a href="framework.html#formatting-a-vignette"><i class="fa fa-check"></i><b>1.2.2</b> Formatting a Vignette</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="framework.html"><a href="framework.html#the-r-directory"><i class="fa fa-check"></i><b>1.3</b> The R/ Directory</a><ul>
<li class="chapter" data-level="1.3.1" data-path="framework.html"><a href="framework.html#normal-use"><i class="fa fa-check"></i><b>1.3.1</b> Normal Use</a></li>
<li class="chapter" data-level="1.3.2" data-path="framework.html"><a href="framework.html#for-data-analysis"><i class="fa fa-check"></i><b>1.3.2</b> For Data Analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-management.html"><a href="data-management.html"><i class="fa fa-check"></i><b>2</b> Data Management</a><ul>
<li class="chapter" data-level="2.1" data-path="data-management.html"><a href="data-management.html#the-data-raw-folder"><i class="fa fa-check"></i><b>2.1</b> The “data-raw” folder</a><ul>
<li class="chapter" data-level="2.1.1" data-path="data-management.html"><a href="data-management.html#when-to-use-it"><i class="fa fa-check"></i><b>2.1.1</b> When to use it</a></li>
<li class="chapter" data-level="2.1.2" data-path="data-management.html"><a href="data-management.html#example"><i class="fa fa-check"></i><b>2.1.2</b> Example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>3</b> Getting Started</a><ul>
<li class="chapter" data-level="3.1" data-path="getting-started.html"><a href="getting-started.html#setting-up-a-r-package"><i class="fa fa-check"></i><b>3.1</b> Setting Up a R Package</a><ul>
<li class="chapter" data-level="3.1.1" data-path="getting-started.html"><a href="getting-started.html#the-basics"><i class="fa fa-check"></i><b>3.1.1</b> The Basics</a></li>
<li class="chapter" data-level="3.1.2" data-path="getting-started.html"><a href="getting-started.html#git-and-github"><i class="fa fa-check"></i><b>3.1.2</b> Git and GitHub</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="getting-started.html"><a href="getting-started.html#working-remotely"><i class="fa fa-check"></i><b>3.2</b> Working Remotely</a><ul>
<li class="chapter" data-level="3.2.1" data-path="getting-started.html"><a href="getting-started.html#sublimetext3-set-up"><i class="fa fa-check"></i><b>3.2.1</b> SublimeText3 Set-Up</a></li>
<li class="chapter" data-level="3.2.2" data-path="getting-started.html"><a href="getting-started.html#using-ssh-file-system"><i class="fa fa-check"></i><b>3.2.2</b> Using SSH File System</a></li>
<li class="chapter" data-level="3.2.3" data-path="getting-started.html"><a href="getting-started.html#git-and-github-1"><i class="fa fa-check"></i><b>3.2.3</b> Git and GitHub</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="getting-started.html"><a href="getting-started.html#extras"><i class="fa fa-check"></i><b>3.3</b> Extras</a><ul>
<li class="chapter" data-level="3.3.1" data-path="getting-started.html"><a href="getting-started.html#pkgdown"><i class="fa fa-check"></i><b>3.3.1</b> pkgdown</a></li>
<li class="chapter" data-level="3.3.2" data-path="getting-started.html"><a href="getting-started.html#travis-ci-appveyor-and-codecov"><i class="fa fa-check"></i><b>3.3.2</b> Travis-CI, Appveyor, and Codecov</a></li>
<li class="chapter" data-level="3.3.3" data-path="getting-started.html"><a href="getting-started.html#spelling"><i class="fa fa-check"></i><b>3.3.3</b> Spelling</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="getting-started.html"><a href="getting-started.html#conclusion"><i class="fa fa-check"></i><b>3.4</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="workflow.html"><a href="workflow.html"><i class="fa fa-check"></i><b>4</b> Workflow</a><ul>
<li class="chapter" data-level="4.0.1" data-path="workflow.html"><a href="workflow.html#document"><i class="fa fa-check"></i><b>4.0.1</b> Document</a></li>
<li class="chapter" data-level="4.0.2" data-path="workflow.html"><a href="workflow.html#test"><i class="fa fa-check"></i><b>4.0.2</b> Test</a></li>
<li class="chapter" data-level="4.0.3" data-path="workflow.html"><a href="workflow.html#build-and-install"><i class="fa fa-check"></i><b>4.0.3</b> Build and Install</a></li>
<li class="chapter" data-level="4.0.4" data-path="workflow.html"><a href="workflow.html#check"><i class="fa fa-check"></i><b>4.0.4</b> Check</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="example-allele-specific-kras-cna.html"><a href="example-allele-specific-kras-cna.html"><i class="fa fa-check"></i><b>5</b> Example: Allele-specific <em>KRAS</em> CNA</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
<li><a href="https://github.com/jhrcook/package-as-analysis" target="blank">Source</a><li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Package as Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-management" class="section level1">
<h1><span class="header-section-number">2</span> Data Management</h1>
<p>This is the most annoying part of a large data analysis project. Usually, the goal is to stike a balance between complexity and ease-of-use. The R package framework does most of the work, but there are a few finicky details.</p>
<p>The data structure is divided between 3 directories at the project root:</p>
<ol style="list-style-type: decimal">
<li><strong>data-raw</strong> - messey and raw data that needs a bit of work to be ready for use in the vignettes</li>
<li><strong>inst/extdata</strong> - data that is analyzed in the vignettes; is usually not tidy but not too messy either</li>
<li><strong>data</strong> - <em>tidy</em> data that is meant to be reusable and is important to the project</li>
</ol>
<p>The order listed above is from least to most prepared. Each has a role and purpose for existing.</p>
<div id="the-data-raw-folder" class="section level2">
<h2><span class="header-section-number">2.1</span> The “data-raw” folder</h2>
<div id="when-to-use-it" class="section level3">
<h3><span class="header-section-number">2.1.1</span> When to use it</h3>
<p>The “data-raw” directory is meant to hold the messy and unorganized data that needs a bit of help to get to a usable state. Therefore, the data stored there should be accompanied by a R script that puts them into the simplest usable state. I think it is best practice to have an individual script for each data type because it is meant to be simple and easy to understand. The main idea is to do the fewest steps possible to get the data into a slightly more useful state and stored in “inst/extdata”.</p>
<p>Most data can likely skip “data-raw” and go directly into “inst/extdata”. As you can tell from the previous paragraph, the decision between putting data into “data-raw” and “inst/extdata” comes down to one’s definitions of “messy” and “usable”. However, there is one case (at least that I have come across) where using data-raw is required (i.e. <code>R CMD check</code> throws an error is you do not).</p>
<p>The one case where the data must be stored in “data-raw” and then preprocessed to “inst/extdata” is if it is a lot of small data files that will be joined together. If the package is built (using <code>devtools::build()</code>), a warning for each file (which can potentially be a lot of files!) will be thrown saying it is bad to compress all of these small files.</p>
<pre class="sourceCode r"><code class="sourceCode r">devtools<span class="op">::</span><span class="kw">install</span>()
<span class="co">#&gt; ...</span>
<span class="co">#&gt; Warning in utils::tar(filepath, pkgname, compression = &quot;gzip&quot;, compression_level = 9L,  :</span>
<span class="co">#&gt;      storing paths of more than 100 bytes is not portable:</span>
<span class="co">#&gt;      &quot;ExampleAnalysisPackage/path/to/offending/file.txt&quot;</span>
<span class="co">#&gt; ...</span></code></pre>
<p>To avoid this, I read all of the data into a single object (usually a list) and then save that to “inst/extdata”.</p>
</div>
<div id="example" class="section level3">
<h3><span class="header-section-number">2.1.2</span> Example</h3>
<p>Since the R script is in “data-raw”, it will not be built with the rest of the package. Therefore, it is important to clearly state the intedned working durectory. To stay consistent, I recommend staying in the package’s root directory.</p>
<p>However, the common case where I will use “data-raw” is if I have a folder with a lot of small data files that will be joined together.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="framework.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="getting-started.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["package-as-analysis.pdf", "package-as-analysis.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
